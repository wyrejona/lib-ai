{% extends "base.html" %}

{% block title %}Dashboard - Library Support AI{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/index.css">
{% endblock %}

{% block content %}
<div class="container">
    <header>
        <div class="logo">
            <i class="fas fa-brain"></i>
            <h1>Library Support AI</h1>
        </div>
        
        <div class="nav-links">
            <a href="/" class="nav-link {% if request.url.path == '/' %}active{% endif %}">
                <i class="fas fa-home"></i> Home
            </a>
            <a href="/files" class="nav-link {% if request.url.path == '/files' %}active{% endif %}">
                <i class="fas fa-folder"></i> Manage Files
            </a>
            <a href="/chat" class="nav-link {% if request.url.path == '/chat' %}active{% endif %}">
                <i class="fas fa-comments"></i> Chat
            </a>
        </div>
    </header>

    <section class="welcome-section">
        <h2>Welcome!</h2>
        <p>System Reliability Dashboard for Library Research AI</p>
        <p><small>Manage your AI models and system resources from this dashboard.</small></p>
    </section>

    <div class="grid-menu">
        <a href="/chat" class="menu-card">
            <i class="fas fa-comments"></i>
            <h3>AI Chat Interface</h3>
            <p>Query your uploaded research papers using natural language.</p>
            <span style="color: var(--primary); font-weight: bold;">Open Chat →</span>
        </a>

        <a href="/files" class="menu-card">
            <i class="fas fa-file-invoice"></i>
            <h3>Document Manager</h3>
            <p>Upload, delete, and process PDF files for the vector store.</p>
            <span style="color: var(--primary); font-weight: bold;">Manage Files →</span>
        </a>
    </div>

    <!-- Quick Status Grid -->
    <div class="status-grid">
        <div class="status-card">
            <h4>Chat Model</h4>
            <div class="status-value" id="currentChatModel">Loading...</div>
            <div class="timestamp" id="chatModelTime"></div>
        </div>
        
        <div class="status-card">
            <h4>Embedding Model</h4>
            <div class="status-value" id="currentEmbeddingModel">Loading...</div>
            <div class="timestamp" id="embeddingModelTime"></div>
        </div>
        
        <div class="status-card">
            <h4>Vector Store</h4>
            <div class="status-value" id="vectorStoreStatus">Checking...</div>
            <div class="timestamp" id="vectorStoreTime"></div>
        </div>
        
        <div class="status-card">
            <h4>Ollama Connection</h4>
            <div class="status-value" id="ollamaStatus">Checking...</div>
            <div class="timestamp" id="ollamaTime"></div>
        </div>
    </div>

    <!-- System Resources -->
    <div class="system-resources">
        <h2><i class="fas fa-chart-line"></i> System Resources</h2>
        
        <div class="resource-card">
            <h3><i class="fas fa-memory"></i> Memory Usage</h3>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="memoryProgress" style="width: 0%"></div>
                </div>
                <div class="resource-stats">
                    <span id="memoryUsed">0 GB</span>
                    <span id="memoryPercent">0%</span>
                    <span id="memoryTotal">0 GB</span>
                </div>
            </div>
        </div>
        
        <div class="resource-card">
            <h3><i class="fas fa-microchip"></i> CPU Usage</h3>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="cpuProgress" style="width: 0%"></div>
                </div>
                <div class="resource-stats">
                    <span id="cpuCores">Cores: 0</span>
                    <span id="cpuPercent">0%</span>
                    <span id="cpuLoad">Load: 0.0</span>
                </div>
            </div>
        </div>
        
        <div class="resource-card">
            <h3><i class="fas fa-hdd"></i> Disk Usage</h3>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="diskProgress" style="width: 0%"></div>
                </div>
                <div class="resource-stats">
                    <span id="diskUsed">0 GB</span>
                    <span id="diskPercent">0%</span>
                    <span id="diskTotal">0 GB</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Model Management -->
    <div class="model-management">
        <h2><i class="fas fa-cogs"></i> Model Management</h2>
        
        <div class="model-card">
            <h3><i class="fas fa-robot"></i> Chat Model</h3>
            <p>Select a chat model for Q&A:</p>
            <select id="chatModelSelect" class="model-select">
                <option value="">Loading models...</option>
            </select>
            <button onclick="dashboard.updateChatModel()" class="update-btn" id="updateChatBtn" disabled>
                <i class="fas fa-sync-alt"></i> Update Chat Model
            </button>
        </div>
        
        <div class="model-card">
            <h3><i class="fas fa-language"></i> Embedding Model</h3>
            <p>Select an embedding model for document search:</p>
            <select id="embeddingModelSelect" class="model-select">
                <option value="">Loading models...</option>
            </select>
            <button onclick="dashboard.updateEmbeddingModel()" class="update-btn" id="updateEmbeddingBtn" disabled>
                <i class="fas fa-sync-alt"></i> Update Embedding Model
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/index.js"></script>
{% endblock %}
